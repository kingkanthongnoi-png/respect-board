<script>
const apiURL = "https://script.google.com/macros/s/AKfycbwf-kY_y0PWE_5ZBJIhRFhCA5IO17Ieok9YOU6vMFYbLzAPr5x5Dt87UJdokFS9Si34kg/exec";

async function loadMessages() {
  const res = await fetch(apiURL);
  const data = await res.json();

  document.querySelectorAll(".balloon").forEach(b => b.remove());

  data.reverse().forEach((row, i) => {
    const balloon = document.createElement("div");
    balloon.className = "balloon";
    balloon.style.left = (10 + (i * 20) % 80) + "%";
    balloon.style.animationDuration = (22 + i * 3) + "s";

    balloon.innerHTML = `
      <div class="balloon-content">
        <div class="to">TO ${row.to}</div>
        <div class="message">${row.message}</div>
      </div>
      <div class="basket"></div>
    `;

    document.body.appendChild(balloon);
  });
}

loadMessages();
setInterval(loadMessages, 10000); // รีเฟรชทุก 10 วิ
</script>
